{% extends 'base.html' %}
{% load static %}
{% block content %}
    <div class="page-title"  style="background-color: white;" data-aos="fade">
        <div class="heading">
          <div class="container">
            <div class="row d-flex justify-content-center text-center">
              <div class="col-lg-8">
                <h1>Contact Pinova Team</h1>
                <p class="mb-0" >Make an impact together. Reach out to us today!</p>
              </div>
            </div>
          </div>
        </div>
        
  <!-- Contact Section -->
  <section id="contact" class="contact section py-0">
  
      <div class="container" data-aos="fade" data-aos-delay="100">
  
        <div class="row gy-4">
  
          <div class="col-lg-4">
            <div class="info-item d-flex"  data-aos-delay="200">
              <i class="bi bi-geo-alt flex-shrink-0"
               style="background: linear-gradient(45deg, #09414d, #56b4d3); color: white;"></i>
              <div>
                <h3>Address</h3>
                <p>Dodoma, Tanzania</p>
              </div>
            </div><!-- End Info Item -->
  
            <div class="info-item d-flex"  data-aos-delay="300">
              <i class="bi bi-telephone flex-shrink-0"  
              style="background: linear-gradient(45deg, #09414d, #56b4d3); color: white;"></i>
              <div>
                <h3>Call Us</h3>
                <p>+255 762 521 584</p>
              </div>
            </div><!-- End Info Item -->
  
            <div class="info-item d-flex"  data-aos-delay="400">
              <i class="bi bi-envelope flex-shrink-0"
              style="background: linear-gradient(45deg, #09414d, #56b4d3); color: white;"></i>
              <div>
                <h3>Email Us</h3>
                <p>pinovatechnologies@gmail.com</p>
              </div>
            </div><!-- End Info Item -->
  
          </div>
  
          <div class="col-lg-8">
            <form id="contact-form" action="{% url 'contact_data' %}" method="post" class="php-email-form" enctype="multipart/form-data" data-aos="fade-up" data-aos-delay="200">
                {% csrf_token %}
                <div class="row gy-4">
        
                    <div class="col-md-6">
                        <input type="text" name="name" class="form-control" placeholder="Your Name" required>
                    </div>
        
                    <div class="col-md-6">
                        <input type="email" class="form-control" name="email" placeholder="Your Email" required>
                    </div>
        
                    <div class="col-md-12">
                        <textarea class="form-control" name="description" rows="6" placeholder="Project Description" required></textarea>
                    </div>
        
                    <div class="col-md-12">
                        <label for="requirements-doc" class="form-label">Upload Project Requirements Document (optional):</label>
                        <input type="file" name="requirements_doc" id="requirements-doc" class="form-control">
                    </div>
        
                    <div id="response-message"></div>
        
                    <div class="col-md-12 text-center">
                        <div class="loading" style="display: none;">Loading...</div>

                        <button type="submit" style="background: linear-gradient(45deg, #09414d, #56b4d3)">Send Message</button>
                    </div>
        
                </div>
            </form>
        </div>
        
        </div>
  
      </div>
    </section>
    <br>
    <script>
      $(document).ready(function() {
          $('#contact-form').submit(function(e) {
              e.preventDefault();  // Prevent the form from reloading the page
      
              // Get the form data
              var formData = new FormData(this);  
              var $submitBtn = $('#submit-btn');
      
              // Show the loading message only if it's not already submitted
              if ($('.sent-message').is(':hidden')) {
                  $('.loading').show();  // Show loading spinner
                  $('.sent-message').hide();  // Hide sent message initially
              }
      
              // Disable the submit button to prevent multiple submissions
              $submitBtn.prop('disabled', true);
      
              $.ajax({
                  url: "{% url 'contact_data' %}",  // URL where the form data will be sent
                  type: 'POST',
                  data: formData,
                  processData: false,  // Do not process the data
                  contentType: false,  // Do not set content type
                  success: function(response) {
                      // Hide loading message after the response
                      $('.loading').hide();
      
                      // Enable the submit button after submission
                      $submitBtn.prop('disabled', false);
      
                      // Clear the response message area
                      $('#response-message').empty();
      
                      // Check if the response status is 'success' and display the success message
                      if (response.status === 'success') {
                          // Show success message
                          $('.sent-message').show();
      
                          // Optionally reset the form after success
                          $('#contact-form')[0].reset();
      
                          // Display success message in the response div
                          $('#response-message').html(`
                              <div class="alert alert-success alert-dismissible fade show" role="alert">
                                  ${response.message}
                                  <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                              </div>
                          `);
                      } else {
                          // Handle error scenario
                          $('#response-message').html(`
                              <div class="alert alert-danger alert-dismissible fade show" role="alert">
                                  ${response.message}
                                  <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                              </div>
                          `);
                      }
                  },
                  error: function(xhr, status, error) {
                      // Hide loading message after the error
                      $('.loading').hide();
      
                      // Enable the submit button again in case of an error
                      $submitBtn.prop('disabled', false);
      
                      // If an error occurs in the AJAX call, handle it here
                      var errorMessage = xhr.responseJSON ? xhr.responseJSON.message : 'Failed to send the message. Please try again.';
      
                      // Display the error message
                      $('#response-message').html(`
                          <div class="alert alert-danger alert-dismissible fade show" role="alert">
                              ${errorMessage}
                              <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                          </div>
                      `);
                  }
              });
          });
      });
    </script>
    
    
    

    {% endblock content %}